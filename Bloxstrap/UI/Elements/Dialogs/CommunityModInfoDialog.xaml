<base:WpfUiWindow
    x:Class="Bloxstrap.UI.Elements.Dialogs.CommunityModInfoDialog"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:base="clr-namespace:Bloxstrap.UI.Elements.Base"
    xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
    Title="Mod Information"
    Width="750" 
    SizeToContent="Height"
    Background="{ui:ThemeResource ApplicationBackgroundBrush}"
    ResizeMode="NoResize"
    ExtendsContentIntoTitleBar="True"
    WindowStartupLocation="CenterOwner">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <ui:TitleBar Grid.Row="0" Padding="8" Title="Mod Information" CanMaximize="False" Icon="pack://application:,,,/Bloxstrap.ico" />

        <Grid Grid.Row="1" Margin="16,0,16,16">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="320"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <StackPanel Grid.Column="0" Margin="0,0,16,0">
                <ui:Card Padding="0" Height="180" ClipToBounds="True" VerticalAlignment="Top">
                    <Grid>
                        <Image Source="{Binding Mod.ThumbnailImage}" Stretch="UniformToFill" RenderOptions.BitmapScalingMode="HighQuality"/>
                        <ui:ProgressRing IsIndeterminate="True" Visibility="{Binding Mod.IsLoadingThumbnail, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                    </Grid>
                </ui:Card>

                <ui:Card Margin="0,12,0,0" Padding="12" VerticalAlignment="Top" Visibility="{Binding Mod.IsColorMod, Converter={StaticResource BooleanToVisibilityConverter}}">
                    <StackPanel>
                        <TextBlock Text="Glyph Preview" FontSize="12" FontWeight="SemiBold" Margin="0,0,0,8" />
                        <ScrollViewer MaxHeight="160" VerticalScrollBarVisibility="Auto">
                            <Grid>
                                <ItemsControl ItemsSource="{Binding GlyphItems}">
                                    <ItemsControl.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <WrapPanel HorizontalAlignment="Center"/>
                                        </ItemsPanelTemplate>
                                    </ItemsControl.ItemsPanel>
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Border Width="42" Height="42" Margin="4" Padding="4" CornerRadius="6" Background="{DynamicResource ControlFillColorSecondaryBrush}">
                                                <Viewbox Margin="4">
                                                    <Path Data="{Binding Data}" Fill="{Binding ColorBrush}" Margin="0,24,5,0"/>
                                                </Viewbox>
                                            </Border>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                                <ui:ProgressRing IsIndeterminate="True" Visibility="{Binding IsLoadingGlyphs, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                            </Grid>
                        </ScrollViewer>
                    </StackPanel>
                </ui:Card>
            </StackPanel>

            <ui:Card Grid.Column="1" VerticalAlignment="Top">
                <StackPanel>
                    <TextBlock Text="{Binding Mod.Name}" FontSize="28" FontWeight="Bold" TextWrapping="Wrap"/>
                    <TextBlock Text="{Binding Mod.Author, StringFormat='Created by {0}'}" FontSize="12" />
                    <TextBlock Text="{Binding Mod.HexCode, StringFormat='Hex Code is {0}'}" FontSize="12" />
                    
                    <ui:Badge Content="{Binding Mod.ModTypeDisplay}" Appearance="Primary" HorizontalAlignment="Left" Margin="0,8,0,0"/>

                    <Separator Margin="0,4" Background="{ui:ThemeResource ControlStrokeColorDefaultBrush}"/>

                    <TextBlock Text="Description" FontWeight="SemiBold" Margin="0,0,0,4"/>
                    <TextBlock Text="{Binding Mod.Description}" TextWrapping="Wrap" Margin="0,0,0,24" />

                    <StackPanel VerticalAlignment="Bottom">
                        <ui:ProgressBar Value="{Binding Mod.DownloadProgress}" Margin="0,0,0,8" Height="4" Visibility="{Binding Mod.IsDownloading, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                        <ui:Button Icon="ArrowDownload24" Content="Download" Appearance="Primary" HorizontalAlignment="Stretch" Height="40" Command="{Binding Mod.DownloadCommand}" CommandParameter="{Binding Mod}"/>
                    </StackPanel>
                </StackPanel>
            </ui:Card>
        </Grid>
    </Grid>
</base:WpfUiWindow>